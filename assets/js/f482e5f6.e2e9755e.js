"use strict";(self.webpackChunkrahat_documentation=self.webpackChunkrahat_documentation||[]).push([[3069],{28453:(e,n,l)=>{l.d(n,{R:()=>s,x:()=>r});var t=l(96540);const i={},a=t.createContext(i);function s(e){const n=t.useContext(a);return t.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function r(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:s(e.components),t.createElement(a.Provider,{value:n},e.children)}},41889:(e,n,l)=>{l.r(n),l.d(n,{assets:()=>c,contentTitle:()=>r,default:()=>h,frontMatter:()=>s,metadata:()=>t,toc:()=>o});const t=JSON.parse('{"id":"Core-Modules/Custodial-Wallet-Service","title":"Custodial Wallet Service","description":"Overview","source":"@site/dev-docs/Core-Modules/03.Custodial-Wallet-Service.md","sourceDirName":"Core-Modules","slug":"/Core-Modules/Custodial-Wallet-Service","permalink":"/dev-docs/Core-Modules/Custodial-Wallet-Service","draft":false,"unlisted":false,"editUrl":"https://github.com/rahataid/rahat-documentation/blob/dev/dev-docs/Core-Modules/03.Custodial-Wallet-Service.md","tags":[],"version":"current","lastUpdatedAt":1753960334000,"sidebarPosition":4,"frontMatter":{"sidebar_position":4,"title":"Custodial Wallet Service"},"sidebar":"myAutogeneratedSidebar","previous":{"title":"Beneficiary Management","permalink":"/dev-docs/Core-Modules/Beneficiary-Management"},"next":{"title":"Rahat Microservice Management","permalink":"/dev-docs/Core-Modules/Rahat-Microservice-Management"}}');var i=l(74848),a=l(28453);const s={sidebar_position:4,title:"Custodial Wallet Service"},r="Wallet Service Documentation",c={},o=[{value:"Overview",id:"overview",level:2},{value:"Features",id:"features",level:2},{value:"Multi-Chain Support",id:"multi-chain-support",level:3},{value:"Wallet Management",id:"wallet-management",level:3},{value:"Security &amp; Storage",id:"security--storage",level:3},{value:"Architecture",id:"architecture",level:2},{value:"Core Components",id:"core-components",level:3},{value:"1. Wallet Service (<code>WalletService</code>)",id:"1-wallet-service-walletservice",level:4},{value:"2. Blockchain Provider Registry (<code>BlockchainProviderRegistry</code>)",id:"2-blockchain-provider-registry-blockchainproviderregistry",level:4},{value:"3. Wallet Implementations",id:"3-wallet-implementations",level:4},{value:"4. Storage Layer",id:"4-storage-layer",level:4},{value:"Module Structure",id:"module-structure",level:3},{value:"Configuration",id:"configuration",level:2},{value:"Chain Settings",id:"chain-settings",level:3},{value:"Environment Variables",id:"environment-variables",level:3},{value:"Default RPC Endpoints",id:"default-rpc-endpoints",level:3},{value:"API Endpoints",id:"api-endpoints",level:2},{value:"Microservice Patterns",id:"microservice-patterns",level:3},{value:"1. Create Wallets",id:"1-create-wallets",level:4},{value:"2. Wallet Retrieval",id:"2-wallet-retrieval",level:4},{value:"Usage Examples",id:"usage-examples",level:2},{value:"1. Creating a Single Wallet",id:"1-creating-a-single-wallet",level:3},{value:"2. Creating Multiple Wallets",id:"2-creating-multiple-wallets",level:3},{value:"3. Bulk Wallet Creation",id:"3-bulk-wallet-creation",level:3},{value:"4. Importing Existing Wallet",id:"4-importing-existing-wallet",level:3},{value:"5. Connecting to Existing Wallet",id:"5-connecting-to-existing-wallet",level:3},{value:"6. Phone Number Association",id:"6-phone-number-association",level:3},{value:"7. Address Validation",id:"7-address-validation",level:3},{value:"Data Types",id:"data-types",level:2},{value:"Wallet Keys",id:"wallet-keys",level:3},{value:"Connected Wallet",id:"connected-wallet",level:3},{value:"Bulk Operations",id:"bulk-operations",level:3},{value:"Security Considerations",id:"security-considerations",level:2},{value:"Private Key Storage",id:"private-key-storage",level:3},{value:"Chain Isolation",id:"chain-isolation",level:3},{value:"Access Control",id:"access-control",level:3},{value:"Error Handling",id:"error-handling",level:2},{value:"Future Enhancements",id:"future-enhancements",level:2},{value:"Multi-Chain Support",id:"multi-chain-support-1",level:3},{value:"Planned Features",id:"planned-features",level:3},{value:"Integration",id:"integration",level:2},{value:"With Beneficiary Service",id:"with-beneficiary-service",level:3},{value:"With Settings Service",id:"with-settings-service",level:3},{value:"Testing",id:"testing",level:2},{value:"Monitoring",id:"monitoring",level:2},{value:"Conclusion",id:"conclusion",level:2}];function d(e){const n={code:"code",h1:"h1",h2:"h2",h3:"h3",h4:"h4",header:"header",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,a.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(n.header,{children:(0,i.jsx)(n.h1,{id:"wallet-service-documentation",children:"Wallet Service Documentation"})}),"\n",(0,i.jsx)(n.h2,{id:"overview",children:"Overview"}),"\n",(0,i.jsxs)(n.p,{children:["The Wallet Service is a core component of the Rahat platform that provides comprehensive wallet management capabilities for blockchain-based humanitarian aid operations. It supports both ",(0,i.jsx)(n.strong,{children:"EVM-based chains"})," (Ethereum, Base, Polygon, etc.) and ",(0,i.jsx)(n.strong,{children:"Stellar chain"}),", enabling secure wallet creation, management, and transaction handling."]}),"\n",(0,i.jsx)(n.h2,{id:"features",children:"Features"}),"\n",(0,i.jsx)(n.h3,{id:"multi-chain-support",children:"Multi-Chain Support"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"EVM Chains"}),": Support for Ethereum-compatible blockchains (Ethereum, Base, Polygon, etc.)"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Stellar Chain"}),": Support for Stellar blockchain with Soroban smart contracts"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Dynamic Chain Detection"}),": Automatic detection of chain type from wallet addresses"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Chain-Specific Configuration"}),": Separate RPC endpoints and network settings for each chain type"]}),"\n"]}),"\n",(0,i.jsx)(n.h3,{id:"wallet-management",children:"Wallet Management"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Wallet Creation"}),": Generate new wallets for any supported chain"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Bulk Wallet Creation"}),": Create multiple wallets in a single operation"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Wallet Import"}),": Import existing wallets using private keys"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Wallet Connection"}),": Connect to existing wallets for transaction signing"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Address Validation"}),": Validate wallet addresses for supported chains"]}),"\n"]}),"\n",(0,i.jsx)(n.h3,{id:"security--storage",children:"Security & Storage"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Secure Storage"}),": File-based storage with encryption support"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Private Key Management"}),": Secure handling of private keys and wallet secrets"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Phone Number Association"}),": Link wallet addresses to beneficiary phone numbers"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Bulk Operations"}),": Secure bulk wallet operations for beneficiary management"]}),"\n"]}),"\n",(0,i.jsx)(n.h2,{id:"architecture",children:"Architecture"}),"\n",(0,i.jsx)(n.h3,{id:"core-components",children:"Core Components"}),"\n",(0,i.jsxs)(n.h4,{id:"1-wallet-service-walletservice",children:["1. Wallet Service (",(0,i.jsx)(n.code,{children:"WalletService"}),")"]}),"\n",(0,i.jsx)(n.p,{children:"The main service class that orchestrates wallet operations:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-typescript",children:"@Injectable()\nexport class WalletService implements OnModuleInit {\n  // Core wallet operations\n  async createWallet(chainType?: ChainType): Promise<WalletKeys>\n  async create(chains: ChainType[]): Promise<WalletCreateResult[]>\n  async createBulk(count: number): Promise<WalletCreateResult[]>\n  async importWallet(privateKey: string, chain?: ChainType): Promise<WalletKeys>\n  async connectWallet(address: string, chain?: ChainType): Promise<IConnectedWallet>\n}\n"})}),"\n",(0,i.jsxs)(n.h4,{id:"2-blockchain-provider-registry-blockchainproviderregistry",children:["2. Blockchain Provider Registry (",(0,i.jsx)(n.code,{children:"BlockchainProviderRegistry"}),")"]}),"\n",(0,i.jsx)(n.p,{children:"Manages wallet implementations for different blockchain types:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-typescript",children:"export class BlockchainProviderRegistry {\n  // Register and manage wallet managers\n  async initializeChain(chainType: ChainType, config?: any): Promise<void>\n  async createWallet(chainType: ChainType): Promise<WalletKeys>\n  async connectWallet(address: string, chainType: ChainType): Promise<IConnectedWallet>\n  validateAddress(address: string, chainType: ChainType): boolean\n}\n"})}),"\n",(0,i.jsx)(n.h4,{id:"3-wallet-implementations",children:"3. Wallet Implementations"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"EVMWallet"}),": Handles Ethereum-compatible chains"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"StellarWallet"}),": Handles Stellar blockchain operations"]}),"\n"]}),"\n",(0,i.jsx)(n.h4,{id:"4-storage-layer",children:"4. Storage Layer"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"FileWalletStorage"}),": File-based wallet storage with encryption support"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"MemoryWalletStorage"}),": In-memory storage for testing"]}),"\n"]}),"\n",(0,i.jsx)(n.h3,{id:"module-structure",children:"Module Structure"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:"apps/rahat/src/wallet/\n\u251c\u2500\u2500 wallet.service.ts          # Main service logic\n\u251c\u2500\u2500 wallet.controller.ts       # API endpoints\n\u251c\u2500\u2500 wallet.module.ts          # Module configuration\n\u251c\u2500\u2500 providers/\n\u2502   \u2514\u2500\u2500 blockchain-provider.registry.ts  # Chain management\n\u251c\u2500\u2500 storages/\n\u2502   \u2514\u2500\u2500 fs.storage.ts         # File storage implementation\n\u251c\u2500\u2500 types/\n\u2502   \u2514\u2500\u2500 chain-config.interface.ts       # Configuration types\n\u2514\u2500\u2500 dto/\n    \u2514\u2500\u2500 getBy.dto.ts          # Data transfer objects\n"})}),"\n",(0,i.jsx)(n.h2,{id:"configuration",children:"Configuration"}),"\n",(0,i.jsx)(n.h3,{id:"chain-settings",children:"Chain Settings"}),"\n",(0,i.jsx)(n.p,{children:"The wallet service uses a centralized configuration system through the Settings service:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-typescript",children:"interface ChainConfig {\n  chainId: string;\n  name: string;\n  type: 'evm' | 'stellar';\n  rpcUrl: string;\n  explorerUrl: string;\n  currency: {\n    name: string;\n    symbol: string;\n  };\n}\n"})}),"\n",(0,i.jsx)(n.h3,{id:"environment-variables",children:"Environment Variables"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"WALLET_PATH"}),": Custom storage directory for wallet files"]}),"\n",(0,i.jsxs)(n.li,{children:["Default storage: ",(0,i.jsx)(n.code,{children:"./wallet_storage/"})]}),"\n"]}),"\n",(0,i.jsx)(n.h3,{id:"default-rpc-endpoints",children:"Default RPC Endpoints"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"EVM"}),": ",(0,i.jsx)(n.code,{children:"https://base-sepolia-rpc.publicnode.com"})]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Stellar"}),": ",(0,i.jsx)(n.code,{children:"https://stellar-soroban-public.nodies.app"})]}),"\n"]}),"\n",(0,i.jsx)(n.h2,{id:"api-endpoints",children:"API Endpoints"}),"\n",(0,i.jsx)(n.h3,{id:"microservice-patterns",children:"Microservice Patterns"}),"\n",(0,i.jsx)(n.p,{children:"The wallet service uses NestJS microservice patterns for internal communication:"}),"\n",(0,i.jsx)(n.h4,{id:"1-create-wallets",children:"1. Create Wallets"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-typescript",children:"// Create single wallet\n@MessagePattern({ cmd: WalletJobs.CREATE })\ncreate(chains: ChainType[])\n\n// Create bulk wallets\n@MessagePattern({ cmd: WalletJobs.CREATE_BULK })\ncreateBulk(chains: BulkCreateWallet)\n\n// Update beneficiaries with new wallets\n@MessagePattern({ cmd: WalletJobs.UPDATE_BULK })\nupdateBulk(chains: BulkUpdateWallet)\n"})}),"\n",(0,i.jsx)(n.h4,{id:"2-wallet-retrieval",children:"2. Wallet Retrieval"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-typescript",children:"// Get wallet by phone number\n@MessagePattern({ cmd: WalletJobs.GET_WALLET_BY_PHONE })\ngetWalletByPhone(phoneDto: PhoneNumberDto)\n\n// Get wallet secret by phone\n@MessagePattern({ cmd: WalletJobs.GET_SECRET_BY_PHONE })\ngetSecretByPhone(account: PhoneAddressDto)\n\n// Get wallet secret by address\n@MessagePattern({ cmd: WalletJobs.GET_SECRET_BY_WALLET })\ngetSecretByWallet(account: WalletAddressDto)\n\n// Get bulk wallet secrets\n@MessagePattern({ cmd: WalletJobs.GET_BULK_SECRET_BY_WALLET })\ngetBulkSecretByWallet(accounts: BulkWalletAddressDto)\n"})}),"\n",(0,i.jsx)(n.h2,{id:"usage-examples",children:"Usage Examples"}),"\n",(0,i.jsx)(n.h3,{id:"1-creating-a-single-wallet",children:"1. Creating a Single Wallet"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-typescript",children:"// Create EVM wallet\nconst evmWallet = await walletService.createWallet('evm');\nconsole.log('EVM Wallet:', evmWallet.address);\n\n// Create Stellar wallet\nconst stellarWallet = await walletService.createWallet('stellar');\nconsole.log('Stellar Wallet:', stellarWallet.address);\n"})}),"\n",(0,i.jsx)(n.h3,{id:"2-creating-multiple-wallets",children:"2. Creating Multiple Wallets"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-typescript",children:"// Create wallets for multiple chains\nconst wallets = await walletService.create(['evm', 'stellar']);\nwallets.forEach(wallet => {\n  console.log(`${wallet.chain} Wallet:`, wallet.address);\n});\n"})}),"\n",(0,i.jsx)(n.h3,{id:"3-bulk-wallet-creation",children:"3. Bulk Wallet Creation"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-typescript",children:"// Create 10 wallets for the current chain\nconst bulkWallets = await walletService.createBulk(10);\nconsole.log(`Created ${bulkWallets.length} wallets`);\n"})}),"\n",(0,i.jsx)(n.h3,{id:"4-importing-existing-wallet",children:"4. Importing Existing Wallet"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-typescript",children:"// Import wallet from private key\nconst importedWallet = await walletService.importWallet(privateKey, 'evm');\nconsole.log('Imported Wallet:', importedWallet.address);\n"})}),"\n",(0,i.jsx)(n.h3,{id:"5-connecting-to-existing-wallet",children:"5. Connecting to Existing Wallet"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-typescript",children:"// Connect to existing wallet\nconst connectedWallet = await walletService.connectWallet(walletAddress, 'evm');\n\n// Sign a message\nconst signature = await connectedWallet.signMessage('Hello World');\n\n// Send transaction\nconst tx = await connectedWallet.sendTransaction(transactionData);\n"})}),"\n",(0,i.jsx)(n.h3,{id:"6-phone-number-association",children:"6. Phone Number Association"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-typescript",children:"// Get wallet by phone number\nconst walletAddress = await walletService.getWalletByPhone('+1234567890');\n\n// Get wallet secret by phone\nconst walletKeys = await walletService.getSecretByPhone('+1234567890', 'evm');\n"})}),"\n",(0,i.jsx)(n.h3,{id:"7-address-validation",children:"7. Address Validation"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-typescript",children:"// Validate EVM address\nconst isValidEVM = await walletService.validateAddress('0x1234...', 'evm');\n\n// Validate Stellar address\nconst isValidStellar = await walletService.validateAddress('GABC...', 'stellar');\n"})}),"\n",(0,i.jsx)(n.h2,{id:"data-types",children:"Data Types"}),"\n",(0,i.jsx)(n.h3,{id:"wallet-keys",children:"Wallet Keys"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-typescript",children:"interface WalletKeys {\n  address: string;\n  privateKey: string;\n  publicKey?: string;\n  blockchain: string;\n  mnemonic?: string;\n}\n"})}),"\n",(0,i.jsx)(n.h3,{id:"connected-wallet",children:"Connected Wallet"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-typescript",children:"interface IConnectedWallet {\n  signMessage(message: string): Promise<string>;\n  sendTransaction(rawTransaction: any): Promise<any>;\n  getWalletKeys(): WalletKeys;\n}\n"})}),"\n",(0,i.jsx)(n.h3,{id:"bulk-operations",children:"Bulk Operations"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-typescript",children:"type BulkCreateWallet = {\n  chain?: ChainType;\n  count: number;\n};\n\ntype BulkUpdateWallet = {\n  chain: ChainType;\n  benUuids: string[];\n};\n"})}),"\n",(0,i.jsx)(n.h2,{id:"security-considerations",children:"Security Considerations"}),"\n",(0,i.jsx)(n.h3,{id:"private-key-storage",children:"Private Key Storage"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Private keys are stored in encrypted files"}),"\n",(0,i.jsx)(n.li,{children:"File-based storage with configurable directory"}),"\n",(0,i.jsx)(n.li,{children:"Support for custom storage implementations"}),"\n"]}),"\n",(0,i.jsx)(n.h3,{id:"chain-isolation",children:"Chain Isolation"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Each chain type has separate storage"}),"\n",(0,i.jsx)(n.li,{children:"Chain-specific validation and configuration"}),"\n",(0,i.jsx)(n.li,{children:"Isolated wallet management per chain"}),"\n"]}),"\n",(0,i.jsx)(n.h3,{id:"access-control",children:"Access Control"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Microservice-based access patterns"}),"\n",(0,i.jsx)(n.li,{children:"Internal service communication only"}),"\n",(0,i.jsx)(n.li,{children:"No direct external API exposure"}),"\n"]}),"\n",(0,i.jsx)(n.h2,{id:"error-handling",children:"Error Handling"}),"\n",(0,i.jsx)(n.p,{children:"The wallet service includes comprehensive error handling:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-typescript",children:"// Chain not supported\nif (!this.providerRegistry.getSupportedChains().includes(chainType)) {\n  throw new Error(`Chain ${chainType} not supported in this instance`);\n}\n\n// Configuration missing\nif (!settings || !settings.value) {\n  throw new Error('CHAIN_SETTINGS configuration not found');\n}\n\n// Invalid chain type\nif (!validChainTypes.includes(rawValue.type as ChainType)) {\n  throw new Error(`Invalid chain type \"${rawValue.type}\"`);\n}\n"})}),"\n",(0,i.jsx)(n.h2,{id:"future-enhancements",children:"Future Enhancements"}),"\n",(0,i.jsx)(n.h3,{id:"multi-chain-support-1",children:"Multi-Chain Support"}),"\n",(0,i.jsx)(n.p,{children:"The service is designed for future multi-chain support:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-typescript",children:"// TODO: Multi-chain support - Future enhancement to support multiple chains per instance\n// Currently: One instance = One chain type\n// Future: One instance = Multiple chain types with dynamic selection\n"})}),"\n",(0,i.jsx)(n.h3,{id:"planned-features",children:"Planned Features"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Dynamic Chain Selection"}),": Support multiple chains simultaneously"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Enhanced Storage"}),": Database-backed storage options"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Advanced Encryption"}),": Hardware security module integration"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Transaction Batching"}),": Optimized bulk transaction processing"]}),"\n"]}),"\n",(0,i.jsx)(n.h2,{id:"integration",children:"Integration"}),"\n",(0,i.jsx)(n.h3,{id:"with-beneficiary-service",children:"With Beneficiary Service"}),"\n",(0,i.jsx)(n.p,{children:"The wallet service integrates with the beneficiary management system:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-typescript",children:"// Update beneficiaries with new wallets\nasync updateBulk(bulkUpdateWalletDto: BulkUpdateWallet) {\n  return Promise.all(bulkUpdateWalletDto.benUuids.map(async (uuid) => {\n    const walletAddress = await this.create([bulkUpdateWalletDto.chain]);\n    const beneficiary = await this.prisma.beneficiary.update({\n      where: { uuid },\n      data: { walletAddress: walletAddress[0].address },\n    });\n    return { uuid, walletAddress: beneficiary.walletAddress, secret: walletAddress[0].privateKey };\n  }));\n}\n"})}),"\n",(0,i.jsx)(n.h3,{id:"with-settings-service",children:"With Settings Service"}),"\n",(0,i.jsx)(n.p,{children:"Chain configuration is managed through the settings service:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-typescript",children:"private async getCurrentChainSettings(): Promise<{\n  detectedChain: ChainType;\n  stellar: any;\n  evm: any;\n}> {\n  const settings = await this.settings.getByName('CHAIN_SETTINGS');\n  // ... configuration processing\n}\n"})}),"\n",(0,i.jsx)(n.h2,{id:"testing",children:"Testing"}),"\n",(0,i.jsx)(n.p,{children:"The wallet service includes comprehensive test coverage:"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Unit Tests"}),": ",(0,i.jsx)(n.code,{children:"wallet.service.spec.ts"})]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Controller Tests"}),": ",(0,i.jsx)(n.code,{children:"wallet.controller.spec.ts"})]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Integration Tests"}),": End-to-end wallet operations"]}),"\n"]}),"\n",(0,i.jsx)(n.h2,{id:"monitoring",children:"Monitoring"}),"\n",(0,i.jsx)(n.p,{children:"The service includes logging for monitoring and debugging:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-typescript",children:"private readonly logger = new Logger(WalletService.name);\n\nthis.logger.log(`Creating ${chain} wallet`);\nthis.logger.warn(`Chain ${chainType} not supported in this instance`);\nthis.logger.error('Error reading wallet file:', error);\n"})}),"\n",(0,i.jsx)(n.h2,{id:"conclusion",children:"Conclusion"}),"\n",(0,i.jsx)(n.p,{children:"The Wallet Service provides a robust, secure, and scalable foundation for blockchain wallet management in the Rahat platform. Its support for both EVM and Stellar chains, combined with comprehensive security features and flexible configuration options, makes it suitable for humanitarian aid operations requiring reliable wallet infrastructure."})]})}function h(e={}){const{wrapper:n}={...(0,a.R)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(d,{...e})}):d(e)}}}]);