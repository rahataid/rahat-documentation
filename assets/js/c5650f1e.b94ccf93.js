"use strict";(self.webpackChunkrahat_documentation=self.webpackChunkrahat_documentation||[]).push([[9768],{14409:(n,e,s)=>{s.r(e),s.d(e,{assets:()=>l,contentTitle:()=>o,default:()=>h,frontMatter:()=>t,metadata:()=>i,toc:()=>c});const i=JSON.parse('{"id":"Project-Modules/Crypto-to-Crypto/Multisig Disbursement","title":"Multisig Disbursement","description":"Overview","source":"@site/dev-docs/Project-Modules/02.Crypto-to-Crypto/03.Multisig Disbursement.md","sourceDirName":"Project-Modules/02.Crypto-to-Crypto","slug":"/Project-Modules/Crypto-to-Crypto/Multisig Disbursement","permalink":"/dev-docs/Project-Modules/Crypto-to-Crypto/Multisig Disbursement","draft":false,"unlisted":false,"editUrl":"https://github.com/rahataid/rahat-documentation/blob/dev/dev-docs/Project-Modules/02.Crypto-to-Crypto/03.Multisig Disbursement.md","tags":[],"version":"current","lastUpdatedAt":1754021596000,"sidebarPosition":1,"frontMatter":{"sidebar_position":1,"title":"Multisig Disbursement"},"sidebar":"myAutogeneratedSidebar","previous":{"title":"Installation","permalink":"/dev-docs/Project-Modules/Crypto-to-Crypto/Installation"},"next":{"title":"Introduction","permalink":"/dev-docs/Project-Modules/Crypto-to-Crypto/Introduction"}}');var r=s(74848),a=s(28453);const t={sidebar_position:1,title:"Multisig Disbursement"},o="Multisig Disbursement",l={},c=[{value:"Overview",id:"overview",level:2},{value:"Architecture",id:"architecture",level:2},{value:"Core Components",id:"core-components",level:3},{value:"Technology Stack",id:"technology-stack",level:3},{value:"Implementation Details",id:"implementation-details",level:2},{value:"1. DisbursementMultisigService",id:"1-disbursementmultisigservice",level:3},{value:"2. Key Methods",id:"2-key-methods",level:3},{value:"Generate Transaction Data",id:"generate-transaction-data",level:4},{value:"Create Safe Transaction",id:"create-safe-transaction",level:4},{value:"Workflow",id:"workflow",level:2},{value:"1. Transaction Creation",id:"1-transaction-creation",level:3},{value:"2. Approval Process",id:"2-approval-process",level:3},{value:"3. Transaction Execution",id:"3-transaction-execution",level:3},{value:"API Endpoints",id:"api-endpoints",level:2},{value:"1. Create Safe Transaction",id:"1-create-safe-transaction",level:3},{value:"2. Get Transaction Approvals",id:"2-get-transaction-approvals",level:3},{value:"3. Get Pending Transactions",id:"3-get-pending-transactions",level:3},{value:"Configuration",id:"configuration",level:2},{value:"Environment Variables",id:"environment-variables",level:3},{value:"Database Settings",id:"database-settings",level:3},{value:"Security Features",id:"security-features",level:2},{value:"1. Multi-Signature Requirements",id:"1-multi-signature-requirements",level:3},{value:"2. Transaction Validation",id:"2-transaction-validation",level:3},{value:"3. Audit Trail",id:"3-audit-trail",level:3},{value:"Use Cases",id:"use-cases",level:2},{value:"1. Humanitarian Aid Distribution",id:"1-humanitarian-aid-distribution",level:3},{value:"2. Development Project Funding",id:"2-development-project-funding",level:3},{value:"3. Microfinance Operations",id:"3-microfinance-operations",level:3},{value:"Integration with Frontend",id:"integration-with-frontend",level:2},{value:"1. Transaction Creation",id:"1-transaction-creation-1",level:3},{value:"2. Transaction Monitoring",id:"2-transaction-monitoring",level:3},{value:"3. Safe Wallet Integration",id:"3-safe-wallet-integration",level:3},{value:"Error Handling",id:"error-handling",level:2},{value:"Common Error Scenarios",id:"common-error-scenarios",level:3},{value:"Error Recovery",id:"error-recovery",level:3},{value:"Monitoring and Analytics",id:"monitoring-and-analytics",level:2},{value:"1. Transaction Metrics",id:"1-transaction-metrics",level:3},{value:"3. Alert System",id:"3-alert-system",level:3},{value:"Best Practices",id:"best-practices",level:2},{value:"1. Safe Configuration",id:"1-safe-configuration",level:3},{value:"2. Transaction Management",id:"2-transaction-management",level:3},{value:"3. Security Considerations",id:"3-security-considerations",level:3},{value:"Troubleshooting",id:"troubleshooting",level:2},{value:"Common Issues",id:"common-issues",level:3}];function d(n){const e={code:"code",h1:"h1",h2:"h2",h3:"h3",h4:"h4",header:"header",li:"li",mermaid:"mermaid",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,a.R)(),...n.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(e.header,{children:(0,r.jsx)(e.h1,{id:"multisig-disbursement",children:"Multisig Disbursement"})}),"\n",(0,r.jsx)(e.h2,{id:"overview",children:"Overview"}),"\n",(0,r.jsxs)(e.p,{children:["The Rahat Project C2C implements a robust multisig disbursement system using ",(0,r.jsx)(e.strong,{children:"Gnosis Safe"})," to ensure secure, transparent, and auditable token transfers. This system requires multiple approvals before executing disbursements, providing enhanced security for humanitarian aid and development project funding."]}),"\n",(0,r.jsx)(e.h2,{id:"architecture",children:"Architecture"}),"\n",(0,r.jsx)(e.h3,{id:"core-components",children:"Core Components"}),"\n",(0,r.jsxs)(e.ol,{children:["\n",(0,r.jsxs)(e.li,{children:[(0,r.jsx)(e.strong,{children:"Gnosis Safe Protocol"}),": Multi-signature wallet implementation"]}),"\n",(0,r.jsxs)(e.li,{children:[(0,r.jsx)(e.strong,{children:"Safe API Kit"}),": Integration with Safe's transaction management"]}),"\n",(0,r.jsxs)(e.li,{children:[(0,r.jsx)(e.strong,{children:"Safe Protocol Kit"}),": Core SDK for Safe operations"]}),"\n",(0,r.jsxs)(e.li,{children:[(0,r.jsx)(e.strong,{children:"DisbursementMultisigService"}),": Backend service handling multisig operations"]}),"\n"]}),"\n",(0,r.jsx)(e.h3,{id:"technology-stack",children:"Technology Stack"}),"\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsxs)(e.li,{children:[(0,r.jsx)(e.strong,{children:"Safe Protocol"}),": ",(0,r.jsx)(e.code,{children:"@safe-global/protocol-kit"})]}),"\n",(0,r.jsxs)(e.li,{children:[(0,r.jsx)(e.strong,{children:"Safe API"}),": ",(0,r.jsx)(e.code,{children:"@safe-global/api-kit"})]}),"\n",(0,r.jsxs)(e.li,{children:[(0,r.jsx)(e.strong,{children:"Ethers.js"}),": Blockchain interaction"]}),"\n",(0,r.jsxs)(e.li,{children:[(0,r.jsx)(e.strong,{children:"NestJS"}),": Backend framework"]}),"\n",(0,r.jsxs)(e.li,{children:[(0,r.jsx)(e.strong,{children:"Prisma"}),": Database ORM"]}),"\n"]}),"\n",(0,r.jsx)(e.h2,{id:"implementation-details",children:"Implementation Details"}),"\n",(0,r.jsx)(e.h3,{id:"1-disbursementmultisigservice",children:"1. DisbursementMultisigService"}),"\n",(0,r.jsx)(e.p,{children:"The core service handling all multisig operations:"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-typescript",children:"@Injectable()\nexport class DisbursementMultisigService {\n  private safeApiKit: SafeApiKit;\n  \n  constructor(protected prisma: PrismaService) {\n    this.safeApiKit = new SafeApiKit({\n      chainId: BigInt(process.env.CHAIN_ID),\n    });\n  }\n}\n"})}),"\n",(0,r.jsx)(e.h3,{id:"2-key-methods",children:"2. Key Methods"}),"\n",(0,r.jsx)(e.h4,{id:"generate-transaction-data",children:"Generate Transaction Data"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-typescript",children:"async generateTransactionData(amount: string) {\n  const CONTRACT = await this.prisma.setting.findUnique({\n    where: { name: 'CONTRACT' }\n  });\n  \n  const c2cAddress = CONTRACT.value['C2CPROJECT']['ADDRESS'];\n  const tokenAddress = CONTRACT.value['RAHATTOKEN']['ADDRESS'];\n  \n  const tokenContract = new ethers.Contract(\n    tokenAddress,\n    erc20Abi,\n    new JsonRpcProvider(process.env.NETWORK_PROVIDER)\n  );\n  \n  const decimals = await tokenContract.decimals();\n  const tokenApprovalEncodedData = tokenContract.interface.encodeFunctionData(\n    'approve',\n    [c2cAddress, ethers.parseUnits(amount, decimals)]\n  );\n  \n  const safeTransactionData: MetaTransactionData = {\n    to: tokenAddress,\n    value: '0',\n    data: tokenApprovalEncodedData,\n    operation: OperationType.Call,\n  };\n  \n  return safeTransactionData;\n}\n"})}),"\n",(0,r.jsx)(e.h4,{id:"create-safe-transaction",children:"Create Safe Transaction"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-typescript",children:"async createSafeTransaction(payload: CreateSafeTransactionDto) {\n  const transactionData = await this.generateTransactionData(payload.amount);\n  const safeWallet = await this.getSafeInstance();\n  \n  const safeTransaction = await safeWallet.createTransaction({\n    transactions: [transactionData],\n  });\n  \n  const safeTxHash = await safeWallet.getTransactionHash(safeTransaction);\n  const signature = await safeWallet.signHash(safeTxHash);\n  \n  await this.safeApiKit.proposeTransaction({\n    safeAddress: safeAddress,\n    safeTransactionData: safeTransaction.data,\n    safeTxHash,\n    senderAddress: deployerWallet.address,\n    senderSignature: signature.data,\n  });\n  \n  return {\n    safeAddress,\n    safeTransactionData: safeTransaction.data,\n    safeTxHash,\n    senderAddress: deployerWallet.address,\n    senderSignature: signature.data,\n  };\n}\n"})}),"\n",(0,r.jsx)(e.h2,{id:"workflow",children:"Workflow"}),"\n",(0,r.jsx)(e.h3,{id:"1-transaction-creation",children:"1. Transaction Creation"}),"\n",(0,r.jsx)(e.mermaid,{value:"sequenceDiagram\n    participant U as User\n    participant B as Backend\n    participant S as Safe Wallet\n    participant C as Contract\n    \n    U->>B: Create Safe Transaction\n    B->>B: Generate Transaction Data\n    B->>S: Create Transaction\n    S->>S: Generate Safe Tx Hash\n    B->>S: Propose Transaction\n    S->>B: Return Transaction Details\n    B->>U: Safe Transaction Hash"}),"\n",(0,r.jsx)(e.h3,{id:"2-approval-process",children:"2. Approval Process"}),"\n",(0,r.jsx)(e.mermaid,{value:"sequenceDiagram\n    participant O1 as Owner 1\n    participant O2 as Owner 2\n    participant S as Safe Wallet\n    participant C as Contract\n    \n    O1->>S: Sign Transaction\n    O2->>S: Sign Transaction\n    S->>S: Check Threshold\n    S->>C: Execute Transaction\n    C->>C: Transfer Tokens"}),"\n",(0,r.jsx)(e.h3,{id:"3-transaction-execution",children:"3. Transaction Execution"}),"\n",(0,r.jsx)(e.mermaid,{value:"sequenceDiagram\n    participant S as Safe Wallet\n    participant T as Token Contract\n    participant P as Project Contract\n    participant B as Beneficiary\n    \n    S->>T: Approve Tokens\n    T->>P: Allow Project to Spend\n    P->>B: Transfer Tokens\n    B->>B: Receive Tokens"}),"\n",(0,r.jsx)(e.h2,{id:"api-endpoints",children:"API Endpoints"}),"\n",(0,r.jsx)(e.h3,{id:"1-create-safe-transaction",children:"1. Create Safe Transaction"}),"\n",(0,r.jsxs)(e.p,{children:[(0,r.jsx)(e.strong,{children:"Endpoint"}),": ",(0,r.jsx)(e.code,{children:"POST /safe-transaction/create"})]}),"\n",(0,r.jsxs)(e.p,{children:[(0,r.jsx)(e.strong,{children:"Request"}),":"]}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-json",children:'{\n  "amount": "100"\n}\n'})}),"\n",(0,r.jsxs)(e.p,{children:[(0,r.jsx)(e.strong,{children:"Response"}),":"]}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-json",children:'{\n  "safeAddress": "0x...",\n  "safeTransactionData": "0x...",\n  "safeTxHash": "0x...",\n  "senderAddress": "0x...",\n  "senderSignature": "0x..."\n}\n'})}),"\n",(0,r.jsx)(e.h3,{id:"2-get-transaction-approvals",children:"2. Get Transaction Approvals"}),"\n",(0,r.jsxs)(e.p,{children:[(0,r.jsx)(e.strong,{children:"Endpoint"}),": ",(0,r.jsx)(e.code,{children:"GET /safe-transaction/approvals"})]}),"\n",(0,r.jsxs)(e.p,{children:[(0,r.jsx)(e.strong,{children:"Request"}),":"]}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-json",children:'{\n  "transactionHash": "0x..."\n}\n'})}),"\n",(0,r.jsxs)(e.p,{children:[(0,r.jsx)(e.strong,{children:"Response"}),":"]}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-json",children:'{\n  "approvals": [\n    {\n      "owner": "0x...",\n      "submissionDate": "2024-01-01T00:00:00Z",\n      "hasApproved": true\n    }\n  ],\n  "confirmationsRequired": 2,\n  "isExecuted": false,\n  "proposer": "0x..."\n}\n'})}),"\n",(0,r.jsx)(e.h3,{id:"3-get-pending-transactions",children:"3. Get Pending Transactions"}),"\n",(0,r.jsxs)(e.p,{children:[(0,r.jsx)(e.strong,{children:"Endpoint"}),": ",(0,r.jsx)(e.code,{children:"GET /safe-transaction/pending"})]}),"\n",(0,r.jsxs)(e.p,{children:[(0,r.jsx)(e.strong,{children:"Response"}),":"]}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-json",children:'{\n  "results": [\n    {\n      "safeTxHash": "0x...",\n      "to": "0x...",\n      "value": "0",\n      "data": "0x...",\n      "operation": 0,\n      "gasToken": "0x0000000000000000000000000000000000000000",\n      "safeTxGas": 0,\n      "baseGas": 0,\n      "gasPrice": "0",\n      "refundReceiver": "0x0000000000000000000000000000000000000000",\n      "nonce": 0,\n      "executionDate": null,\n      "submissionDate": "2024-01-01T00:00:00Z",\n      "modified": "2024-01-01T00:00:00Z",\n      "blockNumber": null,\n      "transactionHash": null,\n      "safeApp": null,\n      "confirmations": [],\n      "signatures": null,\n      "detailedExecutionInfo": null\n    }\n  ]\n}\n'})}),"\n",(0,r.jsx)(e.h2,{id:"configuration",children:"Configuration"}),"\n",(0,r.jsx)(e.h3,{id:"environment-variables",children:"Environment Variables"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-bash",children:"# Safe Configuration\nSAFE_WALLET_ADDRESS=0x...\nDEPLOYER_PRIVATE_KEY=0x...\nCHAIN_ID=84532\nNETWORK_PROVIDER=https://sepolia.base.org\n\n# Contract Addresses\nCONTRACT_C2CPROJECT=0x...\nCONTRACT_RAHATTOKEN=0x...\n"})}),"\n",(0,r.jsx)(e.h3,{id:"database-settings",children:"Database Settings"}),"\n",(0,r.jsx)(e.p,{children:"The system stores Safe configuration in the database:"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-sql",children:'-- Safe Wallet Configuration\nINSERT INTO tbl_settings (name, value, dataType) VALUES (\n  \'SAFE_WALLET\',\n  \'{"ADDRESS": "0x..."}\',\n  \'OBJECT\'\n);\n\n-- Contract Configuration\nINSERT INTO tbl_settings (name, value, dataType) VALUES (\n  \'CONTRACT\',\n  \'{\n    "C2CPROJECT": {"ADDRESS": "0x..."},\n    "RAHATTOKEN": {"ADDRESS": "0x..."}\n  }\',\n  \'OBJECT\'\n);\n'})}),"\n",(0,r.jsx)(e.h2,{id:"security-features",children:"Security Features"}),"\n",(0,r.jsx)(e.h3,{id:"1-multi-signature-requirements",children:"1. Multi-Signature Requirements"}),"\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsxs)(e.li,{children:[(0,r.jsx)(e.strong,{children:"Threshold Configuration"}),": Configurable number of required signatures"]}),"\n",(0,r.jsxs)(e.li,{children:[(0,r.jsx)(e.strong,{children:"Owner Management"}),": Add/remove Safe owners"]}),"\n",(0,r.jsxs)(e.li,{children:[(0,r.jsx)(e.strong,{children:"Time Locks"}),": Optional time delays for large transactions"]}),"\n"]}),"\n",(0,r.jsx)(e.h3,{id:"2-transaction-validation",children:"2. Transaction Validation"}),"\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsxs)(e.li,{children:[(0,r.jsx)(e.strong,{children:"Balance Checks"}),": Verify sufficient token balance"]}),"\n",(0,r.jsxs)(e.li,{children:[(0,r.jsx)(e.strong,{children:"Contract Validation"}),": Ensure contract addresses are correct"]}),"\n",(0,r.jsxs)(e.li,{children:[(0,r.jsx)(e.strong,{children:"Gas Estimation"}),": Calculate required gas for execution"]}),"\n"]}),"\n",(0,r.jsx)(e.h3,{id:"3-audit-trail",children:"3. Audit Trail"}),"\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsxs)(e.li,{children:[(0,r.jsx)(e.strong,{children:"Transaction History"}),": Complete record of all transactions"]}),"\n",(0,r.jsxs)(e.li,{children:[(0,r.jsx)(e.strong,{children:"Approval Tracking"}),": Track who approved each transaction"]}),"\n",(0,r.jsxs)(e.li,{children:[(0,r.jsx)(e.strong,{children:"Execution Logs"}),": Detailed execution information"]}),"\n"]}),"\n",(0,r.jsx)(e.h2,{id:"use-cases",children:"Use Cases"}),"\n",(0,r.jsx)(e.h3,{id:"1-humanitarian-aid-distribution",children:"1. Humanitarian Aid Distribution"}),"\n",(0,r.jsxs)(e.p,{children:[(0,r.jsx)(e.strong,{children:"Scenario"}),": NGO distributing emergency aid to disaster victims"]}),"\n",(0,r.jsxs)(e.p,{children:[(0,r.jsx)(e.strong,{children:"Workflow"}),":"]}),"\n",(0,r.jsxs)(e.ol,{children:["\n",(0,r.jsxs)(e.li,{children:[(0,r.jsx)(e.strong,{children:"Project Setup"}),": Configure Safe with NGO representatives as owners"]}),"\n",(0,r.jsxs)(e.li,{children:[(0,r.jsx)(e.strong,{children:"Beneficiary Registration"}),": Enroll affected individuals"]}),"\n",(0,r.jsxs)(e.li,{children:[(0,r.jsx)(e.strong,{children:"Disbursement Creation"}),": Create multisig transaction for token transfer"]}),"\n",(0,r.jsxs)(e.li,{children:[(0,r.jsx)(e.strong,{children:"Multi-Party Approval"}),": Require approval from multiple NGO officials"]}),"\n",(0,r.jsxs)(e.li,{children:[(0,r.jsx)(e.strong,{children:"Execution"}),": Execute transaction after sufficient approvals"]}),"\n",(0,r.jsxs)(e.li,{children:[(0,r.jsx)(e.strong,{children:"Verification"}),": Track all transactions on blockchain"]}),"\n"]}),"\n",(0,r.jsx)(e.h3,{id:"2-development-project-funding",children:"2. Development Project Funding"}),"\n",(0,r.jsxs)(e.p,{children:[(0,r.jsx)(e.strong,{children:"Scenario"}),": Government agency managing development grants"]}),"\n",(0,r.jsxs)(e.p,{children:[(0,r.jsx)(e.strong,{children:"Workflow"}),":"]}),"\n",(0,r.jsxs)(e.ol,{children:["\n",(0,r.jsxs)(e.li,{children:[(0,r.jsx)(e.strong,{children:"Grant Allocation"}),": Set up Safe with government officials"]}),"\n",(0,r.jsxs)(e.li,{children:[(0,r.jsx)(e.strong,{children:"Milestone Tracking"}),": Link disbursements to project milestones"]}),"\n",(0,r.jsxs)(e.li,{children:[(0,r.jsx)(e.strong,{children:"Approval Workflow"}),": Require approvals from different departments"]}),"\n",(0,r.jsxs)(e.li,{children:[(0,r.jsx)(e.strong,{children:"Transparent Execution"}),": Execute transfers with full audit trail"]}),"\n"]}),"\n",(0,r.jsx)(e.h3,{id:"3-microfinance-operations",children:"3. Microfinance Operations"}),"\n",(0,r.jsxs)(e.p,{children:[(0,r.jsx)(e.strong,{children:"Scenario"}),": Microfinance institution providing loans"]}),"\n",(0,r.jsxs)(e.p,{children:[(0,r.jsx)(e.strong,{children:"Workflow"}),":"]}),"\n",(0,r.jsxs)(e.ol,{children:["\n",(0,r.jsxs)(e.li,{children:[(0,r.jsx)(e.strong,{children:"Loan Approval"}),": Create Safe transaction for loan disbursement"]}),"\n",(0,r.jsxs)(e.li,{children:[(0,r.jsx)(e.strong,{children:"Credit Committee"}),": Require approvals from credit committee members"]}),"\n",(0,r.jsxs)(e.li,{children:[(0,r.jsx)(e.strong,{children:"Risk Management"}),": Implement additional checks for large amounts"]}),"\n",(0,r.jsxs)(e.li,{children:[(0,r.jsx)(e.strong,{children:"Repayment Tracking"}),": Monitor loan repayments through blockchain"]}),"\n"]}),"\n",(0,r.jsx)(e.h2,{id:"integration-with-frontend",children:"Integration with Frontend"}),"\n",(0,r.jsx)(e.h3,{id:"1-transaction-creation-1",children:"1. Transaction Creation"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-typescript",children:"// Frontend code to create Safe transaction\nconst createSafeTransaction = async (amount: string) => {\n  const response = await fetch('/api/safe-transaction/create', {\n    method: 'POST',\n    headers: { 'Content-Type': 'application/json' },\n    body: JSON.stringify({ amount })\n  });\n  \n  const transaction = await response.json();\n  return transaction;\n};\n"})}),"\n",(0,r.jsx)(e.h3,{id:"2-transaction-monitoring",children:"2. Transaction Monitoring"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-typescript",children:"// Monitor transaction status\nconst getTransactionStatus = async (safeTxHash: string) => {\n  const response = await fetch(`/api/safe-transaction/approvals`, {\n    method: 'POST',\n    headers: { 'Content-Type': 'application/json' },\n    body: JSON.stringify({ transactionHash: safeTxHash })\n  });\n  \n  const status = await response.json();\n  return status;\n};\n"})}),"\n",(0,r.jsx)(e.h3,{id:"3-safe-wallet-integration",children:"3. Safe Wallet Integration"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-typescript",children:"// Connect to Safe wallet\nimport Safe from '@safe-global/protocol-kit';\n\nconst connectToSafe = async (safeAddress: string) => {\n  const safe = await Safe.init({\n    provider: window.ethereum,\n    signer: window.ethereum.getSigner(),\n    safeAddress\n  });\n  \n  return safe;\n};\n"})}),"\n",(0,r.jsx)(e.h2,{id:"error-handling",children:"Error Handling"}),"\n",(0,r.jsx)(e.h3,{id:"common-error-scenarios",children:"Common Error Scenarios"}),"\n",(0,r.jsxs)(e.ol,{children:["\n",(0,r.jsxs)(e.li,{children:["\n",(0,r.jsx)(e.p,{children:(0,r.jsx)(e.strong,{children:"Insufficient Balance"})}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-json",children:'{\n  "error": "Insufficient token balance",\n  "code": "INSUFFICIENT_BALANCE",\n  "required": "1000",\n  "available": "500"\n}\n'})}),"\n"]}),"\n",(0,r.jsxs)(e.li,{children:["\n",(0,r.jsx)(e.p,{children:(0,r.jsx)(e.strong,{children:"Insufficient Approvals"})}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-json",children:'{\n  "error": "Insufficient approvals",\n  "code": "INSUFFICIENT_APPROVALS",\n  "required": 2,\n  "received": 1\n}\n'})}),"\n"]}),"\n",(0,r.jsxs)(e.li,{children:["\n",(0,r.jsx)(e.p,{children:(0,r.jsx)(e.strong,{children:"Transaction Failed"})}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-json",children:'{\n  "error": "Transaction execution failed",\n  "code": "EXECUTION_FAILED",\n  "reason": "Gas limit exceeded"\n}\n'})}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(e.h3,{id:"error-recovery",children:"Error Recovery"}),"\n",(0,r.jsxs)(e.ol,{children:["\n",(0,r.jsxs)(e.li,{children:[(0,r.jsx)(e.strong,{children:"Retry Mechanism"}),": Automatic retry for failed transactions"]}),"\n",(0,r.jsxs)(e.li,{children:[(0,r.jsx)(e.strong,{children:"Gas Adjustment"}),": Dynamic gas estimation and adjustment"]}),"\n",(0,r.jsxs)(e.li,{children:[(0,r.jsx)(e.strong,{children:"Fallback Options"}),": Alternative execution paths for failed transactions"]}),"\n"]}),"\n",(0,r.jsx)(e.h2,{id:"monitoring-and-analytics",children:"Monitoring and Analytics"}),"\n",(0,r.jsx)(e.h3,{id:"1-transaction-metrics",children:"1. Transaction Metrics"}),"\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsxs)(e.li,{children:[(0,r.jsx)(e.strong,{children:"Success Rate"}),": Percentage of successful transactions"]}),"\n",(0,r.jsxs)(e.li,{children:[(0,r.jsx)(e.strong,{children:"Average Approval Time"}),": Time from creation to execution"]}),"\n",(0,r.jsxs)(e.li,{children:[(0,r.jsx)(e.strong,{children:"Gas Usage"}),": Average gas consumption per transaction"]}),"\n",(0,r.jsxs)(e.li,{children:[(0,r.jsx)(e.strong,{children:"Owner Activity"}),": Frequency of approvals per owner"]}),"\n"]}),"\n",(0,r.jsx)(e.h3,{id:"3-alert-system",children:"3. Alert System"}),"\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsxs)(e.li,{children:[(0,r.jsx)(e.strong,{children:"Threshold Alerts"}),": Notify when approval threshold is reached"]}),"\n",(0,r.jsxs)(e.li,{children:[(0,r.jsx)(e.strong,{children:"Execution Alerts"}),": Notify when transactions are executed"]}),"\n",(0,r.jsxs)(e.li,{children:[(0,r.jsx)(e.strong,{children:"Error Alerts"}),": Notify when transactions fail"]}),"\n"]}),"\n",(0,r.jsx)(e.h2,{id:"best-practices",children:"Best Practices"}),"\n",(0,r.jsx)(e.h3,{id:"1-safe-configuration",children:"1. Safe Configuration"}),"\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsxs)(e.li,{children:[(0,r.jsx)(e.strong,{children:"Owner Diversity"}),": Use multiple independent owners"]}),"\n",(0,r.jsxs)(e.li,{children:[(0,r.jsx)(e.strong,{children:"Threshold Setting"}),": Set appropriate approval thresholds"]}),"\n",(0,r.jsxs)(e.li,{children:[(0,r.jsx)(e.strong,{children:"Time Locks"}),": Implement time locks for large transactions"]}),"\n",(0,r.jsxs)(e.li,{children:[(0,r.jsx)(e.strong,{children:"Emergency Procedures"}),": Plan for emergency situations"]}),"\n"]}),"\n",(0,r.jsx)(e.h3,{id:"2-transaction-management",children:"2. Transaction Management"}),"\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsxs)(e.li,{children:[(0,r.jsx)(e.strong,{children:"Batch Transactions"}),": Group related transactions when possible"]}),"\n",(0,r.jsxs)(e.li,{children:[(0,r.jsx)(e.strong,{children:"Gas Optimization"}),": Optimize gas usage for cost efficiency"]}),"\n",(0,r.jsxs)(e.li,{children:[(0,r.jsx)(e.strong,{children:"Regular Monitoring"}),": Monitor transaction status regularly"]}),"\n",(0,r.jsxs)(e.li,{children:[(0,r.jsx)(e.strong,{children:"Backup Procedures"}),": Maintain backup execution procedures"]}),"\n"]}),"\n",(0,r.jsx)(e.h3,{id:"3-security-considerations",children:"3. Security Considerations"}),"\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsxs)(e.li,{children:[(0,r.jsx)(e.strong,{children:"Private Key Management"}),": Secure storage of private keys"]}),"\n",(0,r.jsxs)(e.li,{children:[(0,r.jsx)(e.strong,{children:"Access Control"}),": Limit access to Safe operations"]}),"\n",(0,r.jsxs)(e.li,{children:[(0,r.jsx)(e.strong,{children:"Audit Logging"}),": Maintain comprehensive audit logs"]}),"\n",(0,r.jsxs)(e.li,{children:[(0,r.jsx)(e.strong,{children:"Regular Reviews"}),": Regular security reviews and updates"]}),"\n"]}),"\n",(0,r.jsx)(e.h2,{id:"troubleshooting",children:"Troubleshooting"}),"\n",(0,r.jsx)(e.h3,{id:"common-issues",children:"Common Issues"}),"\n",(0,r.jsxs)(e.ol,{children:["\n",(0,r.jsxs)(e.li,{children:["\n",(0,r.jsx)(e.p,{children:(0,r.jsx)(e.strong,{children:"Transaction Stuck"})}),"\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsx)(e.li,{children:"Check gas prices and adjust if necessary"}),"\n",(0,r.jsx)(e.li,{children:"Verify all required approvals are received"}),"\n",(0,r.jsx)(e.li,{children:"Check for network congestion"}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(e.li,{children:["\n",(0,r.jsx)(e.p,{children:(0,r.jsx)(e.strong,{children:"Approval Issues"})}),"\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsx)(e.li,{children:"Verify owner addresses are correct"}),"\n",(0,r.jsx)(e.li,{children:"Check signature validity"}),"\n",(0,r.jsx)(e.li,{children:"Ensure proper threshold configuration"}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(e.li,{children:["\n",(0,r.jsx)(e.p,{children:(0,r.jsx)(e.strong,{children:"Contract Integration"})}),"\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsx)(e.li,{children:"Verify contract addresses are correct"}),"\n",(0,r.jsx)(e.li,{children:"Check contract permissions and allowances"}),"\n",(0,r.jsx)(e.li,{children:"Validate transaction data format"}),"\n"]}),"\n"]}),"\n"]})]})}function h(n={}){const{wrapper:e}={...(0,a.R)(),...n.components};return e?(0,r.jsx)(e,{...n,children:(0,r.jsx)(d,{...n})}):d(n)}},28453:(n,e,s)=>{s.d(e,{R:()=>t,x:()=>o});var i=s(96540);const r={},a=i.createContext(r);function t(n){const e=i.useContext(a);return i.useMemo(function(){return"function"==typeof n?n(e):{...e,...n}},[e,n])}function o(n){let e;return e=n.disableParentContext?"function"==typeof n.components?n.components(r):n.components||r:t(n.components),i.createElement(a.Provider,{value:e},n.children)}}}]);